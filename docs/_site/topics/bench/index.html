<!DOCTYPE html>
<html lang=" en ">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Bench</title>
  <meta name="description"
    content="">

  <link rel="stylesheet" href=" /css/main.css ">
  <link rel="canonical" href="http://localhost:4000/topics/bench/">
  <link rel="alternate" type="application/rss+xml" title="K9sAlpha - Manage Your Kubernetes Clusters In Style" href="http://localhost:4000 /feed.xml
    ">
  <script src="https://kit.fontawesome.com/b45e86135f.js" crossorigin="anonymous"></script>
</head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-133652966-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-133652966-1');
</script>

<body>
  <header class="site-header" role="banner">
  <div class="logo">
    <a class="site-logo" href="/">k9sùû™</a>
  </div>
  <div class="cite">
    Kubernetes CLI To Manage Your Clusters In Style!
  </div>
</header>

  <main class="page-content" aria-label="Content">
    <div class="wrapper">
      <div>
  <p><i class="icon fas fa-tachometer-alt fa-7x"></i></p>

<p><br />
<br />
<br /></p>

<h1 id="benchmarking">Benchmarking</h1>

<p><br /></p>

<h2 id="-overview"><img src="/assets/sections/overview.png" width="auto" height="32" /> Overview</h2>

<p>K9s integrates <a href="https://github.com/rakyll/hey">Hey</a> from the brilliant and super talented <a href="https://github.com/rakyll">Jaana Dogan</a>. <code class="highlighter-rouge">Hey</code> is a CLI tool to benchmark HTTP endpoints similar to AB bench. This preliminary feature currently supports benchmarking port-forwards and services (Read the paint on this is way fresh!).</p>

<p>To setup a port-forward, you will need to navigate to the PodView, select a pod and a container that exposes a given port. Using <code class="highlighter-rouge">SHIFT-F</code> a dialog comes up to allow you to specify a local port to forward to. Once acknowledged, you can navigate to the PortForward view (alias <code class="highlighter-rouge">pf</code>) listing out your active port-forwards. Selecting a port-forward and using <code class="highlighter-rouge">CTRL-B</code> will run a benchmark on that HTTP endpoint. To view the results of your benchmark runs, go to the Benchmarks view (alias <code class="highlighter-rouge">be</code>). You should now be able to select a benchmark and view the run stats details by pressing <code class="highlighter-rouge">&lt;ENTER&gt;</code>. NOTE: Port-forwards only last for the duration of the K9s session and will be terminated upon exit.</p>

<p>Initially, the benchmarks will run with the following defaults:</p>

<ul>
  <li>Concurrency Level: 1</li>
  <li>Number of Requests: 200</li>
  <li>HTTP Verb: GET</li>
  <li>Path: /</li>
</ul>

<p>The PortForward view is backed by a new K9s config file namely: <code class="highlighter-rouge">$HOME/.k9s/bench-&lt;my_context&gt;.yml</code>. Each cluster you connect to will have its own bench config file. Changes to this file should automatically update the PortForward view to indicate how you want to run your benchmarks.</p>

<p><br /></p>
<div class="note">
  <i class="fas fa-skull"></i> Please keep in mind this file will likely change in subsequent releases!
</div>

<p><br /></p>

<h2 id="-example"><img src="/assets/sections/examples.png" width="auto" height="32" /> Example</h2>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># $HOME/.k9s/bench-&lt;my_k8s_context&gt;.yml</span>
<span class="na">benchmarks</span><span class="pi">:</span>
  <span class="c1"># Indicates the default concurrency and number of requests setting if a container or service rule does not match.</span>
  <span class="na">defaults</span><span class="pi">:</span>
    <span class="c1"># One concurrent connection</span>
    <span class="na">concurrency</span><span class="pi">:</span> <span class="s">2</span>
    <span class="c1"># Number of requests that will be sent to an endpoint</span>
    <span class="na">requests</span><span class="pi">:</span> <span class="s">1000</span>
  <span class="na">containers</span><span class="pi">:</span>
    <span class="c1"># Containers section allows you to configure your http container's endpoints and benchmarking settings.</span>
    <span class="c1"># NOTE: the container ID syntax uses namespace/pod-name:container-name</span>
    <span class="s">default/nginx:nginx</span><span class="pi">:</span>
      <span class="c1"># Benchmark a container named nginx using POST HTTP verb using http://localhost:port/bozo URL and headers.</span>
      <span class="na">concurrency</span><span class="pi">:</span> <span class="s">1</span>
      <span class="na">requests</span><span class="pi">:</span> <span class="s">10000</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">path</span><span class="pi">:</span> <span class="s">/bozo</span>
        <span class="na">method</span><span class="pi">:</span> <span class="s">POST</span>
        <span class="na">body</span><span class="pi">:</span>
          <span class="pi">{</span><span class="s2">"</span><span class="s">fred"</span><span class="pi">:</span><span class="s2">"</span><span class="s">blee"</span><span class="pi">}</span>
        <span class="na">header</span><span class="pi">:</span>
          <span class="na">Accept</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">text/html</span>
          <span class="na">Content-Type</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">application/json</span>
  <span class="na">services</span><span class="pi">:</span>
    <span class="c1"># Similarly you can Benchmark an HTTP service exposed either via NodePort, LoadBalancer types.</span>
    <span class="c1"># Service ID is ns/svc-name</span>
    <span class="s">default/nginx</span><span class="pi">:</span>
      <span class="c1"># Set the concurrency level</span>
      <span class="na">concurrency</span><span class="pi">:</span> <span class="s">5</span>
      <span class="c1"># Number of requests to be sent</span>
      <span class="na">requests</span><span class="pi">:</span> <span class="s">500</span>
      <span class="na">http</span><span class="pi">:</span>
        <span class="na">method</span><span class="pi">:</span> <span class="s">GET</span>
        <span class="c1"># This setting will depend on whether service is ModePort or LoadBalancer. NodePort may require vendor port tunneling setting.</span>
        <span class="c1"># Set this to a node if ModePort or LB if applicable. IP or dns name.</span>
        <span class="na">host</span><span class="pi">:</span> <span class="s">1.2.3.4</span>
        <span class="na">path</span><span class="pi">:</span> <span class="s">/bumblebeetuna</span>
      <span class="na">auth</span><span class="pi">:</span>
        <span class="na">user</span><span class="pi">:</span> <span class="s">jean-baptiste-emmanuel</span>
        <span class="na">password</span><span class="pi">:</span> <span class="s">Zorg!</span>
</code></pre></div></div>

</div>

<br />
<div>
  <a class="mid-align" href="/">
    <i class="mid-align fas fa-2x fa-hand-point-left"></i>
    &nbsp;<span class="mid-align">Back</span>
  </a>
</div>
<br />
<br />
<hr />
<img class="mid-align" src="/assets/imhotep_logo.png" width="32" height="auto" />
<span class="mid-align">
  ¬© 2020 Imhotep Software LLC.
  All materials licensed under <a class="mid-align" href="http://www.apache.org/licenses/LICENSE-2.0">Apache v2.0</a>
</span>
    </div>
  </main>
</body>

</html>